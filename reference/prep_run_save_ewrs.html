<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Set up, run, and (possibly) save EWR outputs — prep_run_save_ewrs • HydroBOT</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Set up, run, and (possibly) save EWR outputs — prep_run_save_ewrs"><meta name="description" content="This does some directory setup and parsing, runs the EWR tool and, if asked,
saves the output. If the output saves, it also auto-saves both yaml and json
metadata files with all parameters needed to run this part of HydroBOT
with parameters. Scenario metadata is prepended, if found."><meta property="og:description" content="This does some directory setup and parsing, runs the EWR tool and, if asked,
saves the output. If the output saves, it also auto-saves both yaml and json
metadata files with all parameters needed to run this part of HydroBOT
with parameters. Scenario metadata is prepended, if found."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HydroBOT</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.4.9006</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Set up, run, and (possibly) save EWR outputs</h1>

      <div class="d-none name"><code>prep_run_save_ewrs.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This does some directory setup and parsing, runs the EWR tool and, if asked,
saves the output. If the output saves, it also auto-saves both yaml and json
metadata files with all parameters needed to run this part of HydroBOT
with parameters. Scenario metadata is prepended, if found.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">prep_run_save_ewrs</span><span class="op">(</span></span>
<span>  <span class="va">hydro_dir</span>,</span>
<span>  <span class="va">output_parent_dir</span>,</span>
<span>  output_subdir <span class="op">=</span> <span class="st">""</span>,</span>
<span>  scenarios <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  model_format <span class="op">=</span> <span class="st">"Standard time-series"</span>,</span>
<span>  outputType <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  returnType <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  scenarios_from <span class="op">=</span> <span class="st">"directory"</span>,</span>
<span>  file_search <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fill_missing <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  extrameta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rparallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  retries <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  print_runs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  url <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-hydro-dir">hydro_dir<a class="anchor" aria-label="anchor" href="#arg-hydro-dir"></a></dt>
<dd><p>Directory containing hydrographs. Can be an outer directory,
e.g. <code>hydrographs</code> that splits into scenario subdirs, or can be a single
scenario subdir.</p></dd>


<dt id="arg-output-parent-dir">output_parent_dir<a class="anchor" aria-label="anchor" href="#arg-output-parent-dir"></a></dt>
<dd><p>parent directory for the outputs. Can be anything,
but two typical cases:</p><ul><li><p>The directory containing <code>hydro_dir</code>, which puts the <code>module_outputs</code> at the same level as the hydrographs</p></li>
<li><p>If running in batches for single scenarios, may be <code>hydro_dir</code>, which just puts the <code>module_outputs</code> in <code>hydro_dir</code></p></li>
</ul></dd>


<dt id="arg-output-subdir">output_subdir<a class="anchor" aria-label="anchor" href="#arg-output-subdir"></a></dt>
<dd><p>a sub-directory for the outputs, if for example we want
<code>module_output/EWR/V1</code> and <code>module_output/EWR/V2</code></p></dd>


<dt id="arg-scenarios">scenarios<a class="anchor" aria-label="anchor" href="#arg-scenarios"></a></dt>
<dd><p><code>NULL</code> (default) or named list.</p><ul><li><p><code>NULL</code>- finds scenario names by parsing directory names in <code>hydro_dir</code>. If no internal directories, just stays in <code>hydro_dir</code>. This captures the two typical situations discussed for <code>output_parent_dir</code>. If there are other directories in <code>hydro_dir</code> that do not contain hydrological scenarios, should use a character vector.</p></li>
<li><p>named list of paths to files. names become scenario names, paths should be relative to <code>hydro_dir</code>. This allows unusual directory structures.</p></li>
</ul></dd>


<dt id="arg-model-format">model_format<a class="anchor" aria-label="anchor" href="#arg-model-format"></a></dt>
<dd><p>see EWR tool. One of:</p><ul><li><p>'Standard time-series': (default, among other things accepts a csv with a Date column followed by gauge columns, with _flow or _level appended to the gauge number)</p></li>
<li><p>'IQQM - netcdf': in development, finds all netcdf files in <code>hydro_dir</code>. Should also work when <code>hydro_dir</code> is a .zip with netcdfs inside</p></li>
<li><p>'ten thousand year': old default (IQQM - NSW 10,000 years), works nearly the same as standard time-series</p></li>
<li><p>'All Bigmod': previously 'Bigmod - MDBA'</p></li>
<li><p>'Source - NSW (res.csv)'</p></li>
</ul></dd>


<dt id="arg-outputtype">outputType<a class="anchor" aria-label="anchor" href="#arg-outputtype"></a></dt>
<dd><p>list of strings or character vector defining what to save
to disk. One or more of:</p><ul><li><p>'none' (default), do not save outputs- ignored if in a list with others</p></li>
<li><p>'summary',</p></li>
<li><p>'yearly',</p></li>
<li><p>'all_events',</p></li>
<li><p>'all_successful_events',</p></li>
<li><p>'all_interEvents'</p></li>
<li><p>'all_successful_interEvents'</p></li>
</ul></dd>


<dt id="arg-returntype">returnType<a class="anchor" aria-label="anchor" href="#arg-returntype"></a></dt>
<dd><p>list of strings or character vector defining what to return
to the active R session. Same options as <code>outputType</code></p></dd>


<dt id="arg-scenarios-from">scenarios_from<a class="anchor" aria-label="anchor" href="#arg-scenarios-from"></a></dt>
<dd><p>character, default 'directory' gets scenario names from
directory names. If anything else, gets them from filenames (safest).
Expect additional options in future, e.g from metadata.</p></dd>


<dt id="arg-file-search">file_search<a class="anchor" aria-label="anchor" href="#arg-file-search"></a></dt>
<dd><p>character, regex for additional limitations on filenames.
Useful to run a subset of scenarios or if several files have the extension
defined by <code>model_format</code>, but only some are hydrographs.</p></dd>


<dt id="arg-fill-missing">fill_missing<a class="anchor" aria-label="anchor" href="#arg-fill-missing"></a></dt>
<dd><p>logical, default FALSE. If TRUE, figures out the expected
outputs and only runs those that are missing. Useful for long runs that
might break.</p></dd>


<dt id="arg-extrameta">extrameta<a class="anchor" aria-label="anchor" href="#arg-extrameta"></a></dt>
<dd><p>list, extra information to include in saved metadata
documentation for the run. Default NULL.</p></dd>


<dt id="arg-rparallel">rparallel<a class="anchor" aria-label="anchor" href="#arg-rparallel"></a></dt>
<dd><p>logical, default FALSE. If TRUE, parallelises over the
scenarios in hydro_dir using <code>furrr</code>. To use, install <code>furrr</code> and set a
<code><a href="https://future.futureverse.org/reference/plan.html" class="external-link">future::plan()</a></code> (likely <code>multisession</code> or <code>multicore</code>)</p></dd>


<dt id="arg-retries">retries<a class="anchor" aria-label="anchor" href="#arg-retries"></a></dt>
<dd><p>Number of retries if there are errors. 0 is no retries, but
still runs once. Default 2.</p></dd>


<dt id="arg-print-runs">print_runs<a class="anchor" aria-label="anchor" href="#arg-print-runs"></a></dt>
<dd><p>logical, default FALSE. If true, print the set of runs to
be done.</p></dd>


<dt id="arg-url">url<a class="anchor" aria-label="anchor" href="#arg-url"></a></dt>
<dd><p>logical, default FALSE. If TRUE, <code>scenarios</code> needs to be a named
list with full file paths (URLs). This bypasses the otherwise automatic
prepending of hydro_dir onto a named scenario list.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a list of dataframe(s) if <code>returnType</code> is not 'none', otherwise, NULL</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>By far the cleanest way for this to work is to have your input hydrographs in
a file structure with the directories defining the scenarios, and single or
multiple hydrograph files within them. I.e. a structure that does not mix
files of different scenarios in the final directory. If you have that
structure, using <code>scenarios_from = 'directory'</code> will ensure your scenarios
are named uniquely and output files are also unique and not mixed between
scenarios. This is particularly important for parallelising, which depends on
parallelling over scenarios. This structure is then retained in the output
structure, making aggregation simpler as well. If for some reason you
<em>cannot</em> establish this structure, set <code>scenarios_from = 'file'</code>, and
everythign will be given a unique name, but your life will probably be
difficult when aggregating and other subsequent processing, requiring more
work in scripts to make the appropriate comparisons.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Galen Holt, Georgia Dwyer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

