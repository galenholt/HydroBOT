<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Aggregate along theme dimension — theme_aggregate • HydroBOT</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Aggregate along theme dimension — theme_aggregate"><meta name="description" content="Aggregation along the theme dimension uses causal mappings to aggregate from
lower to higher levels. This function sets up the data with specific prep for
the way the theme dimension works, and then wraps general_aggregate(). Many
of the arguments here are just passed through to general aggregate."><meta property="og:description" content="Aggregation along the theme dimension uses causal mappings to aggregate from
lower to higher levels. This function sets up the data with specific prep for
the way the theme dimension works, and then wraps general_aggregate(). Many
of the arguments here are just passed through to general aggregate."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HydroBOT</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.4.9003</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Aggregate along theme dimension</h1>

      <div class="d-none name"><code>theme_aggregate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Aggregation along the theme dimension uses causal mappings to aggregate from
lower to higher levels. This function sets up the data with specific prep for
the way the theme dimension works, and then wraps <code><a href="general_aggregate.html">general_aggregate()</a></code>. Many
of the arguments here are just passed through to general aggregate.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">theme_aggregate</span><span class="op">(</span></span>
<span>  <span class="va">dat</span>,</span>
<span>  <span class="va">from_theme</span>,</span>
<span>  <span class="va">to_theme</span>,</span>
<span>  <span class="va">groupers</span>,</span>
<span>  <span class="va">aggCols</span>,</span>
<span>  <span class="va">funlist</span>,</span>
<span>  <span class="va">causal_edges</span>,</span>
<span>  geonames <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  failmissing <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  auto_ewr_PU <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dat">dat<a class="anchor" aria-label="anchor" href="#arg-dat"></a></dt>
<dd><p>sf or tibble or dataframe of values to aggregate, with necessary
grouping information for non-theme axis (e.g. scenario, location). <em>Not</em>
necessarily the same as <code>data</code> in <code><a href="general_aggregate.html">general_aggregate()</a></code>- this function
makes necessary adjustments to the data before calling
<code><a href="general_aggregate.html">general_aggregate()</a></code></p></dd>


<dt id="arg-from-theme">from_theme<a class="anchor" aria-label="anchor" href="#arg-from-theme"></a></dt>
<dd><p>character, column name of the theme level the data is
currently in</p></dd>


<dt id="arg-to-theme">to_theme<a class="anchor" aria-label="anchor" href="#arg-to-theme"></a></dt>
<dd><p>character, column name of the theme level to aggregate <em>to</em></p></dd>


<dt id="arg-groupers">groupers<a class="anchor" aria-label="anchor" href="#arg-groupers"></a></dt>
<dd><p>as in <code><a href="general_aggregate.html">general_aggregate()</a></code>, with the note that these should
be all grouping columns <em>except</em> the theme column specified by <code>to_theme</code>
and any spatial information. These are both automatically added to
<code>groupers</code> before passing to <code><a href="general_aggregate.html">general_aggregate()</a></code>.</p></dd>


<dt id="arg-aggcols">aggCols<a class="anchor" aria-label="anchor" href="#arg-aggcols"></a></dt>
<dd><p>an expression for the columns to aggregate (the data columns).
See <code>selectcreator</code> for formats</p></dd>


<dt id="arg-funlist">funlist<a class="anchor" aria-label="anchor" href="#arg-funlist"></a></dt>
<dd><p>a list of functions and their arguments used to aggregate the
data. See <code>functionlister</code> for creation in many cases. The situation with a
bare anonymous function, e.g. <code>~mean(., na.rm = T)</code> is not supported
because we need a name. Use a named list if using anonymous functions, e.g.
<code>list(mean = ~mean(., na.rm = T))</code>. <em>If using functions with a
data-variable argument</em>, e.g. weighted.mean with a column of weights, we
now (as of <code>dplyr</code> 1.1) have some workarounds. One option is if specified
<em>as a function argument</em>, the function can just go in as a bare name or
anonymous. If specified elsewhere, it can be wrapped in <code><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">rlang::quo()</a></code>,
e.g. <code>agglist &lt;- rlang::quo(list(mean = mean, wm = ~weighted.mean(., weight_column_name, na.rm = T)))</code>. If it isn't, there is now an internal
workaround to add that on that seems to be stable but may cause unforeseen
issues. This workaround also allows building custom aggregation functions
(not-anonymous) with the data-variable argument either exposed or hardcoded
(see <code><a href="SpatialWeightedMean.html">SpatialWeightedMean()</a></code>). The error checks for names do not work for
quosures, so make sure you name the list if using <code><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">rlang::quo()</a></code>.</p></dd>


<dt id="arg-causal-edges">causal_edges<a class="anchor" aria-label="anchor" href="#arg-causal-edges"></a></dt>
<dd><p>the causal links between theme levels. Needs to include
<code>from_theme</code> and <code>to_theme</code>, but can also include others. Creates the theme
grouping</p></dd>


<dt id="arg-geonames">geonames<a class="anchor" aria-label="anchor" href="#arg-geonames"></a></dt>
<dd><p>additional columns of information to persist through the
aggregation. Cannot change with the main <code>groupers</code>. Developed to persist
information about polygons through subsequent theme aggregations, but could
be more general</p></dd>


<dt id="arg-failmissing">failmissing<a class="anchor" aria-label="anchor" href="#arg-failmissing"></a></dt>
<dd><p>logical, default <code>TRUE</code>: fail if the requested grouping or
aggregation columns not exist. If <code>FALSE</code>, proceed with those that do exist
and silently drop those that don't. Similar to <code><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">tidyselect::all_of()</a></code> vs
<code><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">tidyselect::any_of()</a></code> in <code>tidyselect</code></p></dd>


<dt id="arg-auto-ewr-pu">auto_ewr_PU<a class="anchor" aria-label="anchor" href="#arg-auto-ewr-pu"></a></dt>
<dd><p>logical, default FALSE. If TRUE, automatically infers
whether this is an EWR dataset and has not yet been spatially aggregated.
If so, applies grouping by 'planning_unit_name' and SWSDLName' since EWRs
are defined in those units. The preferred solution is to include it in
<code>groupers</code> here (for on-off), or in <code><a href="multi_aggregate.html">multi_aggregate()</a></code> to use
<code>group_until</code>. If none of those solutions happen, though, it aborts to
prevent incorrect pooling over rows in different planning units and sdl units.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>passed to <code><a href="general_aggregate.html">general_aggregate()</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a dataframe in the same format as read-in (sf or tibble), aggregated
to the <code>to_theme</code> level and retaining desired geographic information if
included</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Galen Holt, Georgia Dwyer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

